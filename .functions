#!/usr/bin/env bash

#switch azure account with fzf
aac() {
  local accounts subs subname sub

  if command -v az &> /dev/null; then
    if command -v jq &> /dev/null; then
      accounts=$(az account list)
      subs=$(echo "$accounts" | jq -r '.[].name')
      subname=$(echo "$subs" | fzf +m)
      sub=$(echo "$accounts" | jq -r --arg subname "$subname" '.[] | select(.name==$subname).id')
      az account set -s $(echo "$sub")
    else
      echo "jq command missing"
    fi
  else
    echo "az command missing"
  fi
}
